/*!build time : 2013-10-15 11:44:45 AM*/
KISSY.add("gallery/KMobileConsole/1.0/index",function(S){function KMobileConsole(){this.init()}var D=S.DOM,E=S.Event,debugEle,aVars=[];return KMobileConsole.prototype={init:function(){var a=this,b=0;debugEle=D.create("<div>"),D.addClass(debugEle,"KMC-debug"),D.css(debugEle,{position:"absolute",top:"0px",left:"0px",width:"100%",fontSize:"12px",cursor:"default",backgroundColor:"#fff",minHeight:"300%",letterSpacing:"0px",zIndex:"99999"});var c="onorientationchange"in window?"orientationchange":"resize";E.on(window,c,function(){window.orientation!=b&&-90==window.orientation?(window.scrollTo(1,1),a.showDebugInfo()):-90!=window.orientation&&debugEle.parentNode&&document.body.removeChild(debugEle),horientation=window.orientation}),E.on(window,"error",function(a){aVars.push({type:"error",message:a.originalEvent})})},log:function(){this.pushLogs(arguments)},show:function(){this.showDebugInfo()},showDebugInfo:function(){for(var self=this;debugEle.firstChild;)debugEle.removeChild(debugEle.firstChild);D.append(debugEle,S.one("body")),D.css(debugEle,"display","block");for(var i=0;i<aVars.length;i++){var msg=D.create("<div>");switch(aVars[i].type){case"log":for(var j=0;j<aVars[i].message.length;j++){var item=self.showMsg(aVars[i].message[j]);D.css(item,{verticalAlign:"top",padding:"2px"}),D.append(item,msg)}D.append(msg,debugEle);break;case"error":self.insertEle(msg,aVars[i].message.message,"#f00"),self.insertEle(msg,"&nbsp;"+aVars[i].message.filename+"  line: "+aVars[i].message.lineno,"#808080"),D.append(msg,debugEle)}D.css(msg,"border-bottom","1px solid #eee")}var exeEle=D.create("<div>"),exeInput=D.create("<input>");D.css(exeEle,"width","100%"),D.css(exeInput,{border:"none",width:"95%",borderBottom:"1px solid #ccc"}),D.attr(exeInput,{placeholder:'js\u4ee3\u7801\u53ef\u4ee5\u5728\u8fd9\u6765\u4e00\u53d1 alert("fire")',autocorrect:"off",autocapitalize:"none"}),E.on(exeInput,"keyup",function(evt){if(13==evt.keyCode){try{var obj=eval(this.value);aVars.push({type:"log",message:[obj]})}catch(e){aVars.push({type:"error",message:[e]})}self.showDebugInfo()}});var arrow=D.create("<span>");D.append(D.create(">"),arrow),D.css(arrow,{color:"#239CD5",fontWeight:"bold",fontSize:"16px"}),D.append(arrow,exeEle),D.append(exeInput,exeEle),D.append(exeEle,debugEle)},showMsg:function(a){var b=this;switch(typeof a){case"number":return b.showNum(a);case"string":return b.showStr(a);case"object":return b.showObj(a);default:return D.create(typeof a)}},showNum:function(a){var b=D.create("<div>");return D.append(D.create(a.toString()),b),D.css(b,{color:"#00f",display:"inline",verticalAlign:"top"}),b},showStr:function(a){var b=D.create("<div>");return D.append(D.create(a),b),D.css(b,{color:"#000",display:"inline",verticalAlign:"top"}),b},showHtm:function(a){var b=this;if(3==a.nodeType){var c=D.create("<span>");return b.insertEle(c,a.nodeValue),c}var d=D.create("<div>");if(1==a.nodeType){b.insertEle(d,"<"),b.insertEle(d,a.tagName.toLowerCase(),"#800080"),b.insertEle(d," ");for(var e=0;e<a.attributes.length;e++)b.insertEle(d,"&nbsp;"),b.insertEle(d,a.attributes[e].nodeName,"#00f"),b.insertEle(d,'="'),b.insertEle(d,a.attributes[e].nodeValue,"#00f"),b.insertEle(d,'"');b.insertEle(d,">"),b.insertEle(d,"&nbsp;....&nbsp;"),b.insertEle(d,"<"),b.insertEle(d,a.tagName.toLowerCase(),"#800080"),b.insertEle(d,"/>")}return D.css(d,{color:"#000",display:"inline",verticalAlign:"top"}),d},insertEle:function(a,b,c){var d=D.create("<span>");D.append(D.create(b),d),c&&D.css(d,"color",c),D.append(d,a)},showObj:function(a){var b=this,c=D.create("<div>");if(!a)return c;if(D.css(c,"display","inline"),a&&a.nodeType)return b.showHtm(a);if(a.length){D.append(D.create("["),c);for(var d=0;d<a.length;d++)D.append(b.showMsg(a[d]),c),d<a.length-1&&D.append(D.create(","),c);D.css(c,"vertical-align","top"),D.append(D.create("]"),c)}else{var e=D.create("<div>"),f=D.create("<span>");D.append(D.create(">>  Object"),f),D.css(f,{color:"#808080",fontSize:"12px"}),D.append(f,e),D.css(e,"display","inline"),e.objVal=a,e.expanded=!1,E.on(e,"click",function(a){if(this.expanded){for(this.firstChild.textContent=">>  Object";this.childNodes.length>1;)this.removeChild(this.lastChild);this.expanded=!1}else D.append(b.expandObject(this.objVal),this),this.firstChild.textContent="\u25bc  Object",this.expanded=!0;a.stopPropagation()}),D.append(e,c),D.css(c,"display","inline-block")}return c},expandObject:function(a){var b=this,c=D.create("<div>");for(var d in a){var e=D.create("<div>"),f=D.create("<span>");D.append(D.create(d+":"),f),D.append(f,e),D.append(b.showMsg(a[d]),e),D.css(e,"vertical-align","top"),D.css(f,{color:"#800080",verticalAlign:"top"}),D.append(e,c)}return D.css(c,"margin-left","14px"),c},pushLogs:function(a){debugEle.parentNode||aVars.push({type:"log",message:a})}},KMobileConsole});